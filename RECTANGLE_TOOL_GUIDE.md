# 🎨 矩形标注工具使用指南

## ✅ 功能已完成！

全新的**微信风格矩形标注工具**已经实现，完美符合你的需求！

---

## 🎯 核心功能

### 1. **主截图 + 多个矩形标注**
- 框选主截图区域（确定截图范围）
- 在主截图上画多个矩形框
- 每个矩形框独立输入文字说明
- 最后统一提交

### 2. **TAPD 自动填充（按 1、2、3 格式）**
- 自动跳转到 TAPD 缺陷提交页面
- 矩形文字按 `1、2、3、` 格式填充到详情

---

## 📖 完整使用流程

### 第一步：启动截图
```
按 Alt+S
```
- 页面冻结
- 出现深色遮罩（微信风格）
- 光标变成十字

### 第二步：框选主截图区域
```
拖拽鼠标框选整个截图范围
```
- 绿色边框
- 右上角显示实时尺寸 `宽 × 高`
- 选区外自动变暗（镂空效果）

### 第三步：工具栏出现
```
┌─────────────────────────┐
│ 🔲 矩形 │ 取消 │ 完成 │
└─────────────────────────┘
```
- 工具栏浮动在主截图上方/下方
- 黑色半透明背景（毛玻璃效果）

### 第四步：点击"矩形"工具
```
点击 🔲 矩形 按钮
```
- 按钮高亮（白色背景）
- 光标保持十字
- 提示：拖拽画矩形框标注问题位置

### 第五步：画矩形 + 输入文字
```
1. 拖拽画第一个矩形
   └─ 松开鼠标 → 立即弹出输入框
   └─ 输入 "姓名必填"
   └─ 点击"确定"或按 Enter

2. 继续画第二个矩形
   └─ 松开鼠标 → 弹出输入框
   └─ 输入 "邮箱格式错误"
   └─ 确定

3. 继续画第三个矩形
   └─ 输入 "电话号码重复"
   └─ 确定
```

**效果预览**：
```
每个矩形显示：
├─ 绿色边框
├─ 左上角圆形编号 ①②③（绿底白字）
└─ 下方文字标签（绿色背景）
```

### 第六步：点击"完成"
```
点击工具栏的 "完成" 按钮
```
- 弹出最终输入面板
- 显示已标注的问题列表

### 第七步：最终输入
```
┌────────────────────────────┐
│ 标注完成                    │
├────────────────────────────┤
│ 已标注问题：                │
│  ① 姓名必填                 │
│  ② 邮箱格式错误             │
│  ③ 电话号码重复             │
│                            │
│ 选择问题标签：              │
│ [表单校验] [其他] ...       │
│                            │
│ 整体问题描述：              │
│ ┌──────────────────────┐  │
│ │用户注册表单多处校验错误│  │
│ └──────────────────────┘  │
│                            │
│        [取消] [提交]        │
└────────────────────────────┘
```
- 选择标签（必填）
- 输入整体问题描述（必填）
- 点击"提交"

### 第八步：自动跳转 TAPD
```
提交后：
├─ 生成合成截图
├─ 截图自动复制到剪贴板
├─ 数据保存到本地
└─ 自动跳转到 TAPD 缺陷提交页面
```

### 第九步：TAPD 自动填充
```
TAPD 页面自动填充：

标题：用户注册表单多处校验错误（page）

详情：
【问题类型】表单校验
【问题描述】用户注册表单多处校验错误

【详细说明】
1、姓名必填
2、邮箱格式错误
3、电话号码重复

【页面地址】https://xxx.com/register
【发现时间】2025-01-08 15:30:00
【附件截图】粘贴后见下方（Ctrl/Cmd+V）
```

### 第十步：粘贴截图
```
在 TAPD 详情框中按 Ctrl+V（Windows）或 Cmd+V（Mac）
```
- 截图自动粘贴
- 截图上显示绿色矩形框 ①②③
- 每个框下方显示对应文字

---

## 🎨 视觉效果

### 最终生成的截图：
```
┌─────────────────────────────────┐
│        用户注册表单              │
│                                 │
│  ①─姓名必填                     │
│  ┏━━━━━━━━━━┓                  │
│  ┃ 姓名：    ┃                  │
│  ┗━━━━━━━━━━┛                  │
│                                 │
│  ②─邮箱格式错误                 │
│  ┏━━━━━━━━━━━━━━┓              │
│  ┃ 邮箱：        ┃              │
│  ┗━━━━━━━━━━━━━━┛              │
│                                 │
│  ③─电话号码重复                 │
│  ┏━━━━━━━━━━━━┓                │
│  ┃ 电话：      ┃                │
│  ┗━━━━━━━━━━━━┛                │
│                                 │
└─────────────────────────────────┘
```

---

## 🎮 快捷键

| 快捷键 | 功能 |
|--------|------|
| Alt+S | 启动/退出截图 |
| Esc | 取消操作 |
| Enter | 确认输入 |

---

## 💡 使用技巧

### 1. 矩形框的位置
- 不一定要框住整个元素
- 可以画小框指向问题位置
- 可以画大框突出整个区域

### 2. 文字输入
- 简短描述最佳（10-20字）
- 文字会显示在矩形下方
- 超过15字会显示省略号（完整文字在 title 中）

### 3. 取消矩形
- 画完矩形后，点击"取消"按钮
- 该矩形会被删除
- 可以重新画

### 4. 最终提交
- 至少需要画一个矩形
- 标签和整体描述必填
- 提交后会自动跳转 TAPD

---

## 📊 数据结构

### 保存的数据：
```javascript
{
  // 整体信息
  tag: "表单校验",
  issue: "用户注册表单多处校验错误",

  // 矩形标注（重点！）
  rectangles: [
    { order: 1, text: "姓名必填", x, y, width, height },
    { order: 2, text: "邮箱格式错误", x, y, width, height },
    { order: 3, text: "电话号码重复", x, y, width, height }
  ],

  // 页面信息
  pageURL: "https://xxx.com/register",
  timestamp: "2025-01-08 15:30:00",

  // 合成截图（包含矩形框和文字）
  screenshot: "data:image/png;base64..."
}
```

### TAPD 填充格式：
```
【详细说明】
1、姓名必填
2、邮箱格式错误
3、电话号码重复
```

---

## 🆚 与旧版本的区别

| 功能 | 旧版（多区域框选）| 新版（矩形标注）|
|------|------------------|-----------------|
| 主截图区域 | 多个独立区域 | **一个主区域** |
| 标注方式 | 连续框选多个区域 | **在主区域上画矩形框** |
| 文字输入 | 统一描述 | **每个矩形独立输入** |
| 最终效果 | 多个红框 + 统一描述 | **多个绿框 + 独立文字** |
| TAPD 填充 | 统一描述 | **按 1、2、3 格式** |
| 适用场景 | 多处相同问题 | **多处不同问题** |

---

## ⚠️ 注意事项

### 1. 主截图区域
- 主截图区域要包含所有问题位置
- 不要框太小，否则矩形画不下
- 建议留一些边距

### 2. 矩形数量
- 理论上无限制
- 建议不超过 10 个（太多影响可读性）
- 每个矩形必须输入文字（否则会取消）

### 3. TAPD 填充
- 矩形文字会按 `1、2、3、` 格式填充
- 如果没有矩形，会显示"（无详细标注）"
- 截图需要手动粘贴（Ctrl/Cmd+V）

### 4. 截图质量
- 截图只包含主区域范围
- 不是全屏截图
- 分辨率根据 DPR 自动调整

---

## 🔧 故障排除

### 问题 1：输入框无法打字
- 已修复，所有输入框都设置了 `pointer-events: auto`

### 问题 2：主截图选不了
- 检查是否按了 Alt+S
- 检查是否有其他覆盖层

### 问题 3：矩形工具不能画
- 先点击"矩形"按钮
- 确保在主截图区域内画

### 问题 4：TAPD 没有自动填充
- 检查 URL 是否包含 `tapd.cn` 或 `tapd.tencent.com`
- 检查是否是新建缺陷页面
- 查看控制台日志

---

## 🎯 与微信截图的对比

| 功能 | 微信截图 | Bug Shot Turbo（新版）|
|------|----------|----------------------|
| 主截图选择 | ✅ | ✅ |
| 矩形标注工具 | ✅ | ✅ |
| 每个矩形独立文字 | ❌ | ✅ **强化版** |
| 问题标签 | ❌ | ✅ 独有 |
| TAPD 自动填充 | ❌ | ✅ 独有 |
| 按序号填充 | ❌ | ✅ 独有 |
| 视觉风格 | 微信绿 | ✅ 完全一致 |

---

## 🚀 立即使用

### 启用新工具：
```
1. 打开 chrome://extensions/
2. 找到 Bug Shot Turbo
3. 点击刷新按钮 🔄
4. 打开任意网页
5. 按 Alt+S 体验！
```

---

## 📝 更新日志

### v0.2.0（当前版本）
- ✅ 全新矩形标注工具
- ✅ 微信风格 UI
- ✅ 每个矩形独立文字
- ✅ TAPD 按 1、2、3 格式填充
- ✅ 实时尺寸显示
- ✅ 输入框可打字（已修复）

### v0.1.0（旧版本）
- 多区域连续框选
- 统一问题描述
- 红色主题

---

## 🎉 总结

**新版矩形标注工具完美实现了你的需求！**

✅ 主截图 + 多个矩形框
✅ 每个矩形独立输入文字
✅ 微信风格视觉
✅ TAPD 按 1、2、3 格式填充
✅ 快捷键 Alt+S 不变

**现在就试试吧！** 🚀
